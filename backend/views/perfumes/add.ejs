<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title><%= title %></title>
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    body {
      background-color: #0c0c0c;
      color: #fff;
      font-family: 'Poppins', sans-serif;
      margin: 0;
      padding: 0;
    }

    .page-container {
      margin-left: 200px;
      display: flex;
      justify-content: center;
      margin-top: 150px;
    }

    .perfume-form-container {
      background: #151515;
      padding: 30px;
      border-radius: 10px;
      width: 600px;
      box-shadow: 0 0 15px rgba(255, 0, 50, 0.2);
    }

    h2 {
      text-align: center;
      color: #c41e3a;
      margin-bottom: 25px;
      font-weight: 600;
      font-size: 26px;
    }

    label {
      display: block;
      margin-bottom: 6px;
      color: #ccc;
      font-size: 14px;
    }

    input, textarea, select {
      width: 100%;
      padding: 10px;
      margin-bottom: 15px;
      border-radius: 6px;
      border: none;
      background: #222;
      color: #fff;
      font-size: 15px;
    }

    textarea {
      resize: none;
    }

    input[type="file"] {
      border: none;
      padding: 8px 0;
      color: #ccc;
    }

    /* --- Nút hành động --- */
    .form-actions {
  display: grid;
  grid-template-columns: 1fr 1fr; /* chia đều 2 cột */
  gap: 20px;
  margin-top: 20px;
}

.btn-action {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 8px;
  width: 100%;          /* mỗi nút chiếm trọn cột */
  text-align: center;
  padding: 14px 0;
  border-radius: 8px;
  border: none;
  cursor: pointer;
  font-size: 16px;
  font-weight: 500;
  transition: 0.3s;
  text-decoration: none;
  color: #fff;
}

    .btn-save {
      background: #c41e3a;
    }

    .btn-save:hover {
      background: #a0142e;
    }

    .btn-back {
      background: #333;
    }

    .btn-back:hover {
      background: #555;
    }

    .error {
      color: #ff4d4d;
      text-align: center;
      margin-bottom: 10px;
      font-size: 14px;
    }
  </style>
</head>

<body>
  <%- include('../partials/admindashboard') %>

  <div class="page-container">
    <div class="perfume-form-container">
      <h2><%= perfume ? 'Chỉnh sửa nước hoa' : 'Thêm nước hoa mới' %></h2>

      <% if (typeof error !== 'undefined' && error) { %>
        <p class="error"><%= error %></p>
      <% } %>

      <form action="<%= perfume ? '/perfumes/edit/' + perfume._id : '/perfumes/add' %>" 
            method="POST" enctype="multipart/form-data">

        <label for="perfumeName">Tên nước hoa *</label>
        <input type="text" id="perfumeName" name="perfumeName" 
               value="<%= perfume ? perfume.perfumeName : '' %>" required>

        <label for="uri">Đường dẫn URI *</label>
        <input type="text" id="uri" name="uri" 
               value="<%= perfume ? perfume.uri : '' %>" placeholder="vd: https://example.com/perfume-uri" required>

        <label for="price">Giá (VND) *</label>
        <input type="number" id="price" name="price" 
               value="<%= perfume ? perfume.price : '' %>" step="0.01" required>

        <label for="concentration">Nồng độ *</label>
        <select id="concentration" name="concentration" required>
          <option value="">-- Chọn nồng độ --</option>
          <option value="Extrait" <%= perfume && perfume.concentration === 'Extrait' ? 'selected' : '' %>>Extrait</option>
          <option value="EDP" <%= perfume && perfume.concentration === 'EDP' ? 'selected' : '' %>>EDP</option>
          <option value="EDT" <%= perfume && perfume.concentration === 'EDT' ? 'selected' : '' %>>EDT</option>
          <option value="Cologne" <%= perfume && perfume.concentration === 'Cologne' ? 'selected' : '' %>>Cologne</option>
        </select>

        <label for="description">Mô tả *</label>
        <textarea id="description" name="description" rows="4" required><%= perfume ? perfume.description : '' %></textarea>

        <label for="ingredients">Thành phần *</label>
        <textarea id="ingredients" name="ingredients" rows="3" required><%= perfume ? perfume.ingredients : '' %></textarea>

        <label for="volume">Dung tích (ml) *</label>
        <input type="number" id="volume" name="volume" 
               value="<%= perfume ? perfume.volume : '' %>" min="1" required>

        <label for="targetAudience">Đối tượng sử dụng *</label>
        <select id="targetAudience" name="targetAudience" required>
          <option value="">-- Chọn đối tượng --</option>
          <option value="male" <%= perfume && perfume.targetAudience === 'male' ? 'selected' : '' %>>Nam</option>
          <option value="female" <%= perfume && perfume.targetAudience === 'female' ? 'selected' : '' %>>Nữ</option>
          <option value="unisex" <%= perfume && perfume.targetAudience === 'unisex' ? 'selected' : '' %>>Unisex</option>
        </select>

        <label for="brand">Thương hiệu *</label>
        <select id="brand" name="brand" required>
          <option value="">-- Chọn thương hiệu --</option>
          <% if (brands && brands.length > 0) { %>
            <% brands.forEach(b => { %>
              <option value="<%= b._id %>" 
                <%= perfume && perfume.brand && perfume.brand.toString() === b._id.toString() ? 'selected' : '' %>>
                <%= b.brandName || b.name %>
              </option>
            <% }) %>
          <% } %>
        </select>

        <label for="image">Hình ảnh</label>
        <input type="file" id="image" name="image" accept="image/*">

        <div class="form-actions">
          <button type="submit" class="btn-action btn-save">
            <i class="fa-solid fa-floppy-disk"></i> Lưu
          </button>
          <a href="/perfumes" class="btn-action btn-back">
            <i class="fa-solid fa-arrow-left"></i> Quay lại
          </a>
        </div>
      </form>
    </div>
  </div>
</body>
</html>
